!function(e){var o=[];e(".cmb-type-map").each((function(){!function(t){var a=e("#_map_address"),n=a.get(0),s=e(".map",t).get(0),l=e("._geolocation_lat",t),p=e("._geolocation_long",t),g=e("._geolocation_elevation",t),i=new google.maps.ElevationService,r=e('[name="_map_type"]'),m=e('[name="_map_zoom"]'),c=e('[name="_map_no_streetview"]'),d={center:new google.maps.LatLng(CMBGmaps.latitude,CMBGmaps.longitude),zoom:parseInt(CMBGmaps._map_zoom),scrollwheel:"true"==CMBGmaps.scrollwheel,streetViewControl:"on"!=CMBGmaps._map_no_streetview},u=new google.maps.Map(s,d);C(CMBGmaps._map_type);var _={map:u,draggable:!0,title:CMBGmaps.markerTitle},v=new google.maps.Marker(_);v.setPosition(d.center),window.google.maps.event.addListener(u,"click",(function(e){M(e.latLng),y(e.latLng)})),window.google.maps.event.addListener(v,"dragend",(function(){M(v.getPosition()),y(v.getPosition())}));var f=new google.maps.places.Autocomplete(n);function w(){var o=parseFloat(document.getElementById("_geolocation_lat").value),a=parseFloat(document.getElementById("_geolocation_long").value);if(o&&a){var n=e(".map",t).get(0),s={center:new google.maps.LatLng(o,a),zoom:parseInt(CMBGmaps._map_zoom),scrollwheel:"true"==CMBGmaps.scrollwheel,streetViewControl:"on"!=CMBGmaps._map_no_streetview},g={map:new google.maps.Map(n,s),draggable:!0,title:CMBGmaps.markerTitle};new google.maps.Marker(g).setPosition({lat:parseFloat(o),lng:parseFloat(a)}),l.val(o),p.val(a)}}function M(e,o){v.setPosition(e,CMBGmaps.zoom),setTimeout((function(){u.panTo(v.getPosition())}),500),o&&u.setZoom(o),l.val(e.lat()),p.val(e.lng()),i.getElevationForLocations({locations:[v.getPosition()]},(function(e,o){o==google.maps.ElevationStatus.OK&&e[0]&&g.val(e[0].elevation)}))}function y(e){var o=new google.maps.LatLng(e.lat(),e.lng());geocoder=new google.maps.Geocoder,geocoder.geocode({latLng:o},(function(e,o){o==google.maps.GeocoderStatus.OK&&(e[0]?a.val(e[0].formatted_address):a.val("invalid address"))}))}function C(e){"ROADMAP"==e&&u.setMapTypeId(google.maps.MapTypeId.ROADMAP),"SATELLITE"==e&&u.setMapTypeId(google.maps.MapTypeId.SATELLITE),"HYBRID"==e&&u.setMapTypeId(google.maps.MapTypeId.HYBRID),"TERRAIN"==e&&u.setMapTypeId(google.maps.MapTypeId.TERRAIN)}f.bindTo("bounds",u),google.maps.event.addListener(f,"place_changed",(function(){M(f.getPlace().geometry.location)})),e(n).keypress((function(e){13===e.keyCode&&e.preventDefault()})),r.change((function(){C(r.filter(":checked").val())})),m.change((function(){var o=e("option:selected",this).val();u.setZoom(parseInt(o))})),c.change((function(){e(this).is(":checked")?u.setOptions({streetViewControl:!1}):u.setOptions({streetViewControl:!0})})),e(document).on("keyup","#_geolocation_lat",(function(e){w()})),e(document).on("keyup","#_geolocation_long",(function(e){w()})),o.push(u)}(e(this))})),"undefined"!=typeof postboxes&&(postboxes.pbshow=function(){for(var e=o.length,t=0;t<e;t++){var a=o[t].getCenter();google.maps.event.trigger(o[t],"resize"),o[t].setCenter(a)}})}(jQuery);